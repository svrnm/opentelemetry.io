---
title: Collector 数据流仪表盘
---

监控 OpenTelemetry Collector 中的数据流具有多重重要意义。
从宏观层面了解输入数据（如样本数量和基数）对于理解 Collector
的内部运行机制至关重要。然而，在深入研究细节时，组件之间的连接可能变得复杂。
Collector 数据流仪表盘旨在展示 OpenTelemetry 演示应用的功能，
为用户提供一个坚实的基础，便于他们进一步扩展。
Collector 数据流仪表盘还提供了有关应监控哪些指标的有价值建议。
用户可以根据自己的使用场景，添加必要的指标
（例如 memory_delimiter 处理器或其他数据流指示器），
以定制自己的仪表盘版本。该演示仪表盘是一个起点，
使用户能够探索各种使用场景，并根据自身的监控需求调整工具。 Gaining a macro-level perspective on incoming data, such as sample
counts and cardinality, is essential for comprehending the collector's internal
dynamics. However, when delving into the details, the interconnections can
become complex. The Collector Data Flow Dashboard aims to demonstrate the
capabilities of the OpenTelemetry demo application, offering a solid foundation
for users to build upon. Collector Data Flow Dashboard provides valuable
guidance on which metrics to monitor. Users can tailor their own dashboard
variations by adding necessary metrics specific to their use cases, such as
memory_delimiter processor or other data flow indicators. This demo dashboard
serves as a starting point, enabling users to explore diverse usage scenarios
and adapt the tool to their unique monitoring needs.

## 数据流概览 {#data-flow-overview}

下图展示了系统组件的整体视图，基于 OpenTelemetry Collector（otelcol）配置文件生成，
该文件由 OpenTelemetry 演示应用使用。
此外，它还展示了系统中的可观测性数据（链路与指标）的流动情况。 Additionally, it highlights
the observability data (traces and metrics) flow within the system.

![OpenTelemetry Collector 数据流概览](otelcol-data-flow-overview.png)

## Ingress/Egress Metrics

The metrics depicted in the diagram below are employed to monitor both egress
and ingress data flows. These metrics are generated by the otelcol process,
exported on port 8888, and subsequently scraped by Prometheus. The namespace
associated with these metrics is "otelcol," and the job name is labeled as
`otel.`

![OpenTelemetry Collector 流入与流出指标](otelcol-data-flow-metrics.png)

Labels serve as a valuable tool for identifying specific metric sets (such as
exporter, receiver, or job), enabling differentiation among metric sets within
the overall namespace. It is important to note that you will only encounter
refused metrics if the memory limits, as defined in the memory delimiter
processor, are exceeded.

### 流入链路管道 {#ingress-traces-pipeline}

- `otelcol_receiver_accepted_spans`
- `otelcol_receiver_refused_spans`
- `by (receiver,transport)`

### 流入指标管道 {#ingress-metrics-pipeline}

- `otelcol_receiver_accepted_metric_points`
- `otelcol_receiver_refused_metric_points`
- `by (receiver,transport)`

### 处理器 {#processor}

目前，演示应用中仅使用了一个批处理器，它被同时用于链路和指标的管道中。

- `otelcol_processor_batch_batch_send_size_sum`

### 流出链路管道 {#egress-traces-pipeline}

- `otelcol_exporter_sent_spans`
- `otelcol_exporter_send_failed_spans`
- `by (exporter)`

### 流出指标管道 {#egress-metrics-pipeline}

- `otelcol_exporter_sent_metric_points`
- `otelcol_exporter_send_failed_metric_points`
- `by (exporter)`

### Prometheus 抓取指标 {#prometheus-scraping}

- `scrape_samples_scraped`
- `by (job)`

## Dashboard

您可以通过进入 Grafana 用户界面（UI），点击左侧的浏览图标，选择
**OpenTelemetry Collector Data Flow** 仪表盘来查看数据流仪表盘。

![OpenTelemetry Collector 数据流仪表盘](otelcol-data-flow-dashboard.png)

该仪表盘包含四个主要部分：

1. 进程指标（Process Metrics）
2. 链路管道（Traces Pipeline）
3. 指标管道（Metrics Pipeline）
4. Prometheus 抓取（Prometheus Scraping）

Sections 2,3 and 4 represent overall data flow using the metrics mentioned
above. Additionally, export ratio is calculated for each pipeline to understand
the data flow.

### 导出比率 {#export-rate}

Export ratio is basically the ratio between receiver and exporter metrics. You
can notice over the dashboard screenshot above that the export ratio on metrics
is way too high than the received metrics. This is because the demo application
is configured to generate span metrics which is a processor that generates
metrics from spans inside collector as illustrated in overview diagram.

### 进程指标 {#process-metrics}

Very limited but informative process metrics are added to dashboard. For
example, you might observe more than one instance of otelcol running on the
system during restarts or similar. This can be useful for understanding spikes
on dataflow.

![OpenTelemetry Collector 进程指标](otelcol-dashboard-process-metrics.png)
